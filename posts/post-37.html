<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="nodeIntegration 위험성. contextIsolation, sandbox, preload 스크립트 패턴">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://ikakao.kr/posts/post-37.html">
  <title>Electron 보안 체크리스트 — contextBridge 제대로 쓰기 | DevInsight</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.min.css">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2446729462046987"
    crossorigin="anonymous"></script>
  <style>
    :root { --font: "Pretendard Variable", "Pretendard", sans-serif; --ink: #1a1a2e; --muted: #6b6b7b; --bg: #f8f6f1; --card: #fff; --border: #d4d0c8; --accent: #c0392b; }
    body { margin: 0; font-family: var(--font); background: var(--bg); color: var(--ink); line-height: 1.85; }
    .wrap { max-width: 800px; margin: 0 auto; padding: 48px 20px 80px; }
    .card { background: var(--card); border: 1px solid var(--border); border-radius: 14px; padding: 34px; }
    h1 { margin: 0 0 10px; font-size: 2rem; line-height: 1.35; }
    h2 { margin: 36px 0 12px; font-size: 1.25rem; border-bottom: 1px solid var(--border); padding-bottom: 6px; }
    h3 { margin: 20px 0 8px; font-size: 1.05rem; color: var(--accent); }
    p { margin: 0 0 16px; }
    ul, ol { margin: 0 0 16px 20px; }
    li { margin-bottom: 8px; }
    pre { background: #2d2d3f; color: #e6e6e6; border-radius: 10px; padding: 14px 16px; overflow-x: auto; font-size: 0.88rem; margin: 0 0 16px; }
    code { background: #eee; padding: 1px 5px; border-radius: 4px; font-size: 0.88em; }
    pre code { background: none; padding: 0; }
    .meta { color: var(--muted); font-size: 0.92rem; margin-bottom: 24px; }
    .note { background: #f3efe6; border: 1px solid var(--border); border-radius: 10px; padding: 12px 16px; margin: 16px 0; font-size: 0.95rem; }
    .back { display: inline-block; margin-top: 28px; color: var(--accent); text-decoration: none; font-weight: 700; }
    table { width: 100%; border-collapse: collapse; margin: 12px 0 16px; }
    th, td { border: 1px solid var(--border); padding: 10px; text-align: left; }
    th { background: #f3efe6; }
    blockquote { border-left: 3px solid var(--accent); margin: 16px 0; padding: 8px 16px; color: var(--muted); }
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fontsource/gowun-batang@5.0.20/700.css">
  <link rel="stylesheet" href="/style.css">
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "Electron 보안 체크리스트 — contextBridge 제대로 쓰기",
    "author": { "@type": "Person", "name": "ian.lab" },
    "publisher": { "@type": "Person", "name": "ian.lab" },
    "datePublished": "2025-08-10",
    "mainEntityOfPage": { "@type": "WebPage", "@id": "https://ikakao.kr/posts/post-37.html" }
  }
  </script>
</head>
<body>
  <header class="site-header">
    <div class="header-inner">
      <a class="logo" href="/">Dev<span>Insight</span></a>
      <nav class="nav-links" aria-label="주요 메뉴">
        <a href="/">홈</a>
        <a href="/archive.html">전체 글</a>
        <a href="/about.html">소개</a>
        <a href="/contact.html">연락처</a>
      </nav>
    </div>
  </header>

  <div class="container-narrow" style="padding:0 20px;">
    <nav class="breadcrumb" aria-label="경로">
      <a href="/">홈</a><span class="sep">/</span>
      <a href="/archive.html">Electron</a><span class="sep">/</span>
      <span>현재 글</span>
    </nav>
  </div>

  <main class="post-wrap">
    <article class="post-card">
      <h1>Electron 보안 체크리스트 — contextBridge 제대로 쓰기</h1>
      <p class="meta">게시일: 2025년 8월 10일 · 14분 읽기</p>

<h2>nodeIntegration: true로 보안 감사에 걸렸다</h2>

<p>처음 Electron 앱을 만들 때, 나는 편의를 위해 `nodeIntegration: true`로 설정했다. 렌더러 프로세스에서 Node.js API를 직접 쓸 수 있어서 편했다. 하지만 1년 뒤 보안 감사에서 걸렸다. "이건 심각한 보안 문제"라고.</p>

<p>그 뒤로 Electron 보안을 제대로 배웠다.</p>

<h3>기본 보안 설정</h3>

<pre><code>&lt;?xml version="1.0"?&gt;
// main.ts
import { app, BrowserWindow } from 'electron'

function createWindow() {
  const win = new BrowserWindow({
    webPreferences: {
      nodeIntegration: false,        // 반드시 false
      contextIsolation: true,        // 반드시 true
      enableRemoteModule: false,     // 반드시 false
      sandbox: true,                 // 반드시 true
      preload: path.join(__dirname, 'preload.ts')
    }
  })

  win.loadFile('index.html')
}

app.on('ready', createWindow)
</code></pre>

<h3>Preload 스크립트로 안전하게 API 노출</h3>

<pre><code>&lt;?xml version="1.0"?&gt;
// preload.ts
import { contextBridge, ipcRenderer } from 'electron'

// 렌더러 프로세스에서 사용할 수 있는 API만 노출
contextBridge.exposeInMainWorld('electronAPI', {
  // IPC 통신 래퍼
  readFile: (filePath: string) =>
    ipcRenderer.invoke('file:read', filePath),

  writeFile: (filePath: string, content: string) =>
    ipcRenderer.invoke('file:write', { filePath, content }),

  getAppVersion: () =>
    ipcRenderer.invoke('app:get-version'),

  // 윈도우 제어
  closeWindow: () =>
    ipcRenderer.send('window:close'),

  // 절대 이렇게 하면 안 됨!
  // require: (module: string) => require(module)  // 위험!
})

// 타입 정의
declare global {
  interface Window {
    electronAPI: {
      readFile: (path: string) => Promise&lt;string&gt;
      writeFile: (path: string, content: string) => Promise&lt;void&gt;
      getAppVersion: () => Promise&lt;string&gt;
      closeWindow: () => void
    }
  }
}
</code></pre>

<h3>메인 프로세스에서 IPC 핸들러</h3>

<pre><code>&lt;?xml version="1.0"?&gt;
// main.ts
import { app, BrowserWindow, ipcMain } from 'electron'
import * as fs from 'fs/promises'
import * as path from 'path'

// 파일 읽기 (권한 확인)
ipcMain.handle('file:read', async (event, filePath: string) => {
  // 보안: 특정 디렉토리만 접근 허용
  const appDataPath = app.getPath('appData')
  const resolvedPath = path.resolve(filePath)

  if (!resolvedPath.startsWith(appDataPath)) {
    throw new Error('Access denied')
  }

  return await fs.readFile(resolvedPath, 'utf-8')
})

// 파일 쓰기 (검증)
ipcMain.handle('file:write', async (event, { filePath, content }) => {
  const appDataPath = app.getPath('appData')
  const resolvedPath = path.resolve(filePath)

  if (!resolvedPath.startsWith(appDataPath)) {
    throw new Error('Access denied')
  }

  // 파일 크기 제한 (DDoS 방지)
  if (content.length > 10 * 1024 * 1024) {  // 10MB
    throw new Error('File too large')
  }

  await fs.writeFile(resolvedPath, content, 'utf-8')
})

ipcMain.handle('app:get-version', async () => {
  return app.getVersion()
})

ipcMain.on('window:close', (event) => {
  BrowserWindow.fromWebContents(event.sender)?.close()
})
</code></pre>

<h3>렌더러 프로세스에서 사용</h3>

<pre><code>&lt;?xml version="1.0"?&gt;
// renderer.ts (또는 React 컴포넌트)
async function loadUserData() {
  try {
    const data = await window.electronAPI.readFile('user-data.json')
    const config = JSON.parse(data)
    console.log(config)
  } catch (error) {
    console.error('Failed to load data:', error)
  }
}

async function saveUserData(config: any) {
  try {
    await window.electronAPI.writeFile(
      'user-data.json',
      JSON.stringify(config, null, 2)
    )
  } catch (error) {
    console.error('Failed to save data:', error)
  }
}

// React에서 사용
function Settings() {
  const [config, setConfig] = useState(null)

  useEffect(() => {
    loadUserData().then(setConfig)
  }, [])

  return (
    &lt;div&gt;
      {config && &lt;p&gt;Version: {window.electronAPI.getAppVersion()}&lt;/p&gt;}
    &lt;/div&gt;
  )
}
</code></pre>

<h3>CSP (Content Security Policy)**</h3>

<pre><code>&lt;?xml version="1.0"?&gt;
// index.html에 CSP 설정
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta charset="UTF-8" /&gt;
  &lt;!-- 중요: 강력한 CSP 설정 --&gt;
  &lt;meta
    http-equiv="Content-Security-Policy"
    content="
      default-src 'self';
      script-src 'self' 'unsafe-inline';
      style-src 'self' 'unsafe-inline';
      img-src 'self' data:;
      font-src 'self';
    "
  /&gt;
  &lt;title&gt;My App&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id="root"&gt;&lt;/div&gt;
  &lt;script src="index.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>또는 코드에서:</p>

<pre><code>&lt;?xml version="1.0"?&gt;
// main.ts
function createWindow() {
  const win = new BrowserWindow({...})

  win.webContents.session.webRequest.onHeadersReceived((details, callback) => {
    callback({
      responseHeaders: {
        ...details.responseHeaders,
        'Content-Security-Policy': [
          "default-src 'self'; " +
          "script-src 'self'; " +
          "style-src 'self' 'unsafe-inline';"
        ]
      }
    })
  })
}
</code></pre>

<h3>업데이트 보안</h3>

<pre><code>&lt;?xml version="1.0"?&gt;
// 자동 업데이트는 HTTPS만 사용
import { autoUpdater } from 'electron-updater'

autoUpdater.checkForUpdatesAndNotify()

// 서명 확인
autoUpdater.on('before-download', () => {
  // 먼저 다운로드 URL 검증
  const url = autoUpdater.currentVersion.releaseUrl
  if (!url.startsWith('https://')) {
    throw new Error('Updates must use HTTPS')
  }
})
</code></pre>

<h3>보안 체크리스트</h3>

<ul>
<li>☐ nodeIntegration: false</li>
<li>☐ contextIsolation: true</li>
<li>☐ enableRemoteModule: false</li>
<li>☐ sandbox: true</li>
<li>☐ preload 스크립트 사용</li>
<li>☐ IPC 핸들러에서 경로 검증</li>
<li>☐ 파일 크기 제한</li>
<li>☐ CSP 헤더 설정</li>
<li>☐ 민감한 정보 암호화</li>
<li>☐ 자동 업데이트는 HTTPS만</li>
<li>☐ 의존성 보안 감사</li>
</ul>

<h3>마무리</h3>

<p>Electron의 보안은 기본이다. 편의를 위해 nodeIntegration을 켜는 건 절대 금지다. contextBridge와 IPC는 조금 번거롭지만, 그만큼의 보안을 제공한다.</p>

<p>처음부터 제대로 하면, 나중에 보안 감사에서 헤맬 일이 없다.</p>


      <div class="author-box">
        <div class="author-avatar">iL</div>
        <div class="author-info">
          <strong>ian.lab</strong>
          <p>28년 경력의 개발자. 실무에서 겪은 문제와 해결 과정을 기록합니다. 오류 제보는 <a href="/contact.html" style="color:var(--accent)">연락처</a>로 보내주세요.</p>
        </div>
      </div>

      <div class="related-posts">
        <h3>관련 글 더 보기</h3>
        <div class="related-list">
        <a class="related-item" href="/posts/post-01.html">
          <span class="ri-cat">Electron</span>
          <span class="ri-title">Electron 앱에서 Rust로 네이티브 성능 확보하기 — N-API 바인딩 실전 가이드</span>
        </a>
        <a class="related-item" href="/posts/post-36.html">
          <span class="ri-cat">Electron</span>
          <span class="ri-title">Electron 앱 빌드 시간 줄이기 — 30분에서 5분으로</span>
        </a>
        <a class="related-item" href="/posts/post-40.html">
          <span class="ri-cat">Electron</span>
          <span class="ri-title">Electron vs Tauri — 2025년 데스크톱 앱 프레임워크 비교</span>
        </a>
        </div>
      </div>
    </article>
</main>

  <footer class="site-footer">
    <div class="footer-inner">
      <div class="footer-links">
        <a href="/">홈</a>
        <a href="/archive.html">전체 글</a>
        <a href="/about.html">소개</a>
        <a href="/contact.html">연락처</a>
        <a href="/editorial-policy.html">운영 원칙</a>
        <a href="/privacy.html">개인정보처리방침</a>
        <a href="/terms.html">이용약관</a>
      </div>
      <div class="footer-copy">
        &copy; 2026 DevInsight. All rights reserved.<br>
        기술 정보는 실제 사용 환경에 맞게 검토 후 적용하세요.
      </div>
    </div>
  </footer>
</body>
</html>