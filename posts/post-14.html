<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="electron-updater 설정, 코드 서명, differential updates, S3/GitHub hosting, 무한 루프 버그">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://ikakao.kr/posts/post-14.html">
  <title>Electron 자동 업데이트 구현 삽질기 — electron-updater의 함정들 | DevInsight</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.min.css">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2446729462046987"
    crossorigin="anonymous"></script>
  <style>
    :root { --font: "Pretendard Variable", "Pretendard", sans-serif; --ink: #1a1a2e; --muted: #6b6b7b; --bg: #f8f6f1; --card: #fff; --border: #d4d0c8; --accent: #c0392b; }
    body { margin: 0; font-family: var(--font); background: var(--bg); color: var(--ink); line-height: 1.85; }
    .wrap { max-width: 800px; margin: 0 auto; padding: 48px 20px 80px; }
    .card { background: var(--card); border: 1px solid var(--border); border-radius: 14px; padding: 34px; }
    h1 { margin: 0 0 10px; font-size: 2rem; line-height: 1.35; }
    h2 { margin: 36px 0 12px; font-size: 1.25rem; border-bottom: 1px solid var(--border); padding-bottom: 6px; }
    h3 { margin: 20px 0 8px; font-size: 1.05rem; color: var(--accent); }
    p { margin: 0 0 16px; }
    ul, ol { margin: 0 0 16px 20px; }
    li { margin-bottom: 8px; }
    pre { background: #2d2d3f; color: #e6e6e6; border-radius: 10px; padding: 14px 16px; overflow-x: auto; font-size: 0.88rem; margin: 0 0 16px; }
    code { background: #eee; padding: 1px 5px; border-radius: 4px; font-size: 0.88em; }
    pre code { background: none; padding: 0; }
    .meta { color: var(--muted); font-size: 0.92rem; margin-bottom: 24px; }
    .note { background: #f3efe6; border: 1px solid var(--border); border-radius: 10px; padding: 12px 16px; margin: 16px 0; font-size: 0.95rem; }
    .back { display: inline-block; margin-top: 28px; color: var(--accent); text-decoration: none; font-weight: 700; }
    table { width: 100%; border-collapse: collapse; margin: 12px 0 16px; }
    th, td { border: 1px solid var(--border); padding: 10px; text-align: left; }
    th { background: #f3efe6; }
    blockquote { border-left: 3px solid var(--accent); margin: 16px 0; padding: 8px 16px; color: var(--muted); }
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fontsource/gowun-batang@5.0.20/700.css">
  <link rel="stylesheet" href="/style.css">
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "Electron 자동 업데이트 구현 삽질기 — electron-updater의 함정들",
    "author": { "@type": "Person", "name": "ian.lab" },
    "publisher": { "@type": "Person", "name": "ian.lab" },
    "datePublished": "2024-12-06",
    "mainEntityOfPage": { "@type": "WebPage", "@id": "https://ikakao.kr/posts/post-14.html" }
  }
  </script>
</head>
<body>
  <header class="site-header">
    <div class="header-inner">
      <a class="logo" href="/">Dev<span>Insight</span></a>
      <nav class="nav-links" aria-label="주요 메뉴">
        <a href="/">홈</a>
        <a href="/archive.html">전체 글</a>
        <a href="/about.html">소개</a>
        <a href="/contact.html">연락처</a>
      </nav>
    </div>
  </header>

  <div class="container-narrow" style="padding:0 20px;">
    <nav class="breadcrumb" aria-label="경로">
      <a href="/">홈</a><span class="sep">/</span>
      <a href="/archive.html">Electron</a><span class="sep">/</span>
      <span>현재 글</span>
    </nav>
  </div>

  <main class="post-wrap">
    <article class="post-card">
      <h1>Electron 자동 업데이트 구현 삽질기 — electron-updater의 함정들</h1>
      <p class="meta">게시일: 2024년 12월 6일 · 16분 읽기</p>

<p>업데이트가 무한 루프 빠진 거 인지하는 데 3일 걸렸다. 사용자 컴퓨터는 계속 재부팅을 반복하고 있었다.</p>

<h3>Setup: electron-updater 기본</h3>

<pre><code>npm install electron-updater
</code></pre>

<p>main.ts:</p>

<pre><code>import { autoUpdater } from 'electron-updater';

app.on('ready', () => {
    autoUpdater.checkForUpdatesAndNotify();
    // ← 이 한 줄로 끝이라고 생각했다
});
</code></pre>

<p>package.json:</p>

<pre><code>{
    "name": "my-app",
    "version": "1.0.0",
    "build": {
        "publish": {
            "provider": "github",  // 또는 "s3"
            "owner": "myname",
            "repo": "my-app"
        }
    }
}
</code></pre>

<h3>문제 1: Code Signing 필수</h3>

<p>업데이트가 검증되지 않으면 설치되지 않는다.</p>

<p>Mac에서:</p>

<pre><code>// package.json build config
"build": {
    "mac": {
        "certificateFile": "path/to/certificate.p12",
        "certificatePassword": "password"
    }
}
</code></pre>

<p>Windows에서:</p>

<pre><code>// package.json
"build": {
    "win": {
        "certificateFile": "path/to/certificate.pfx",
        "certificatePassword": "password"
    }
}
</code></p>

<p>없으면:</p>

<blockquote>
<p>Error: Code sign failed. Signing certificate not found. Unable to find a matching code signing certificate.</p>
</blockquote>

<p>해결: Windows에서는 자체 서명 인증서로 테스트 가능:</p>

<pre><code>// electron-builder는 자체 서명 인증서 생성
// 개발 중에는 코드 서명 건너뛰기
"build": {
    "win": {
        "sign": false  // ← 개발 중에만
    }
}
</code></pre>

<h3>문제 2: 무한 업데이트 루프</h3>

<p>우리의 경우:</p>

<blockquote>
<p>버전 1.0.0 설치됨<br>
자동 업데이트 체크 → 새 버전 1.0.1 있음<br>
1.0.1 설치 및 재부팅<br>
다시 시작된 앱이 자동 업데이트 체크 → 1.0.1이 이미 설치됨, 아무것도 안 함 (OK)<br>
<br>
하지만 우리 경우:<br>
계속 1.0.1을 "새 버전"으로 인식 → 무한 루프</p>
</blockquote>

<p>원인: GitHub release가 잘못 설정됨</p>

<p>electron-updater는 다음을 읽음:</p>

<pre><code>https://api.github.com/repos/myname/my-app/releases/latest
</code></pre>

<p>이 응답에서 "latest" release를 찾는다.</p>

<p>해결: GitHub에서 release를 "Latest Release"로 마크:</p>

<pre><code>// GitHub UI
Release tab → Edit → "Set as the latest release" 체크
</code></pre>

<h3>문제 3: Differential Updates가 안 됨</h3>

<p>differential update는 변경된 부분만 다운로드하는 기능이다 (100MB → 5MB)</p>

<p>작동하려면:</p>

<blockquote>
<p>1. 이전 버전의 .exe 또는 .app이 존재해야 함<br>
2. GitHub release에 최소 2개 이상의 버전이 있어야 함<br>
3. electron-builder가 자동으로 delta 파일 생성해야 함</p>
</blockquote>

<p>github.yml (GitHub Actions):</p>

<pre><code>name: CI

on:
  push:
    tags:
      - 'v*'

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'

      - run: npm install
      - run: npm run build:electron

      - uses: softprops/action-gh-release@v1
        with:
          files: |
            dist/my-app-*.exe
            dist/my-app-*.dmg
            dist/*.blockmap  # ← Delta 정보
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
</code></pre>

<p>중요: dist/*.blockmap을 GitHub release에 업로드해야 delta update가 작동한다.</p>

<h3>문제 4: S3 호스팅</h3>

<p>GitHub 용량 제한 (100MB 이상 안 됨)이 있으면 S3 사용:</p>

<pre><code>// package.json
"build": {
    "publish": {
        "provider": "s3",
        "bucket": "my-app-releases",
        "region": "us-east-1"
    }
}
</code></pre>

<p>AWS IAM 정책:</p>

<pre><code>{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "s3:PutObject",
                "s3:PutObjectAcl"
            ],
            "Resource": "arn:aws:s3:::my-app-releases/*"
        }
    ]
}
</code></pre>

<p>환경변수:</p>

<pre><code>export AWS_ACCESS_KEY_ID=xxx
export AWS_SECRET_ACCESS_KEY=xxx
npm run build:electron  // ← S3에 자동 업로드
</code></pre>

<h3>문제 5: 업데이트 UI</h3>

<p>단순한 자동 업데이트는 사용자가 모른다.</p>

<p>좋은 UX:</p>

<pre><code>import { autoUpdater } from 'electron-updater';

autoUpdater.on('checking-for-update', () => {
    mainWindow.webContents.send('update-status', '업데이트 확인 중...');
});

autoUpdater.on('update-available', () => {
    mainWindow.webContents.send('update-status', '새 버전 다운로드 중...');
});

autoUpdater.on('update-downloaded', () => {
    dialog.showMessageBox(mainWindow, {
        type: 'info',
        title: '업데이트 준비 완료',
        message: '앱을 다시 시작하여 업데이트를 적용합니다.',
        buttons: ['지금 다시 시작', '나중에']
    }).then(result => {
        if (result.response === 0) {
            autoUpdater.quitAndInstall();
        }
    });
});

autoUpdater.on('error', (error) => {
    mainWindow.webContents.send('update-error', error.message);
});

// 1시간마다 체크
setInterval(() => {
    autoUpdater.checkForUpdates();
}, 1000 * 60 * 60);
</code></pre>

<h3>배포 체크리스트</h3>

<blockquote>
<p>□ package.json 버전 업데이트 (예: 1.0.0 → 1.0.1)<br>
□ 코드 서명 인증서 준비<br>
□ npm run build:electron 실행<br>
□ dist/ 폴더에 .exe/.dmg/.blockmap 생성 확인<br>
□ GitHub release 생성 및 파일 업로드<br>
□ "Set as latest release" 체크<br>
□ 이전 버전 앱에서 업데이트 테스트<br>
□ 모니터링 (업데이트 성공률)</p>
</blockquote>

<h3>결론</h3>

<p>electron-updater는 강력하지만 함정이 많다. 특히 code signing과 delta update 설정이 중요하다.</p>

<p>우리는 이 경험 후 모든 업데이트를 다음 버전부터 자동화했다:</p>

<ul>
<li>Git tag 푸시 → GitHub Actions 자동 빌드 및 배포</li>
<li>release-it 도구로 버전/changelog 자동 관리</li>
<li>모니터링: 업데이트 성공/실패율 추적</li>
</ul>

<p>이제 업데이트는 안정적이다. 그리고 사용자는 자동으로 최신 버전을 받는다.</p>


      <div class="author-box">
        <div class="author-avatar">iL</div>
        <div class="author-info">
          <strong>ian.lab</strong>
          <p>28년 경력의 개발자. 실무에서 겪은 문제와 해결 과정을 기록합니다. 오류 제보는 <a href="/contact.html" style="color:var(--accent)">연락처</a>로 보내주세요.</p>
        </div>
      </div>

      <div class="related-posts">
        <h3>관련 글 더 보기</h3>
        <div class="related-list">
        <a class="related-item" href="/posts/post-01.html">
          <span class="ri-cat">Electron</span>
          <span class="ri-title">Electron 앱에서 Rust로 네이티브 성능 확보하기 — N-API 바인딩 실전 가이드</span>
        </a>
        <a class="related-item" href="/posts/post-37.html">
          <span class="ri-cat">Electron</span>
          <span class="ri-title">Electron 보안 체크리스트 — contextBridge 제대로 쓰기</span>
        </a>
        <a class="related-item" href="/posts/post-40.html">
          <span class="ri-cat">Electron</span>
          <span class="ri-title">Electron vs Tauri — 2025년 데스크톱 앱 프레임워크 비교</span>
        </a>
        </div>
      </div>
    </article>
</main>

  <footer class="site-footer">
    <div class="footer-inner">
      <div class="footer-links">
        <a href="/">홈</a>
        <a href="/archive.html">전체 글</a>
        <a href="/about.html">소개</a>
        <a href="/contact.html">연락처</a>
        <a href="/editorial-policy.html">운영 원칙</a>
        <a href="/privacy.html">개인정보처리방침</a>
        <a href="/terms.html">이용약관</a>
      </div>
      <div class="footer-copy">
        &copy; 2026 DevInsight. All rights reserved.<br>
        기술 정보는 실제 사용 환경에 맞게 검토 후 적용하세요.
      </div>
    </div>
  </footer>
</body>
</html>