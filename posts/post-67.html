<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Certbot 설치, Nginx 통합, 자동 갱신, 와일드카드 인증서. 인증서 만료로 서비스 1시간 먹통 된 그 날 이후로">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://ikakao.kr/posts/post-67.html">
  <title>HTTPS 무료 인증서 자동화 — Let's Encrypt + certbot 완전 정복 | Goldtag</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.min.css">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2446729462046987"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fontsource/gowun-batang@5.0.20/700.css">
  <link rel="stylesheet" href="/style.css">
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "HTTPS 무료 인증서 자동화 — Let's Encrypt + certbot 완전 정복",
    "author": { "@type": "Person", "name": "ian.lab" },
    "publisher": { "@type": "Person", "name": "ian.lab" },
    "datePublished": "2025-11-04",
    "mainEntityOfPage": { "@type": "WebPage", "@id": "https://ikakao.kr/posts/post-67.html" }
  }
  </script>
</head>
<body>
  <header class="site-header">
    <div class="header-inner">
      <a class="logo" href="/">Gold<span>tag</span></a>
      <nav class="nav-links" aria-label="주요 메뉴">
        <a href="/">홈</a>
        <a href="/archive.html">전체 글</a>
        <a href="/about.html">소개</a>
        <a href="/contact.html">연락처</a>
      </nav>
    </div>
  </header>

  <div class="container-narrow">
    <nav class="breadcrumb" aria-label="경로">
      <a href="/">홈</a><span class="sep">/</span>
      <a href="/archive.html">DevOps &amp; Infra</a><span class="sep">/</span>
      <span>현재 글</span>
    </nav>
  </div>

  <main class="post-wrap">
    <article class="post-card">
      <h1>HTTPS 무료 인증서 자동화 — Let's Encrypt + certbot 완전 정복</h1>
      <p class="meta">게시일: 2025년 11월 4일 · 13분 읽기</p>
<h2>인증서 만료로 서비스가 먹통 된 경험</h2>
<p>2023년 3월 금요일 오후 4시. 모니터링 알림: 서비스 응답 없음. 원인은 5분 만에 찾았다. HTTPS 인증서가 만료되었다. 하루 전 메일로 갱신 알림이 왔었지만 담당자가 휴가 중이었고, 아무도 처리하지 않았다. 결국 1시간간 서비스가 완전히 다운되었다. 그때부터 나는 "절대 자동화한다"고 다짐했다.</p>

<p>지난 2년, Let's Encrypt와 certbot으로 구축한 자동화 시스템을 설명한다. Ubuntu 기준이지만 대부분의 Linux 배포판에서 동일하다.</p>

<h3>Certbot 설치 — 5분이면 끝</h3>
<p>먼저 설치: sudo apt-get update && sudo apt-get install certbot python3-certbot-nginx. 설치 후 인증서 발급: sudo certbot --nginx -d example.com -d www.example.com. 이 한 명령이 여러 작업을 자동으로 처리한다. Let's Encrypt에서 인증서를 발급받고, Nginx 설정을 자동 수정하며, HTTP를 HTTPS로 리다이렉트하고, 인증서를 /etc/letsencrypt/live/example.com/에 저장한다. Nginx 설정은 자동으로 SSL 설정과 리다이렉트를 추가한다.</p>

<h3>자동 갱신 설정</h3>
<p>인증서는 90일 유효하다. 자동 갱신은 필수다. 먼저 sudo certbot renew --dry-run으로 테스트한다. Systemd timer를 사용해서 매일 정해진 시간에 갱신을 시도하도록 설정한다. /etc/systemd/system/certbot.timer에서 OnCalendar=0 0,12 * * *로 매일 0시와 12시에 실행되도록 한다. 부팅 후 1시간 뒤에도 실행하고, 서버 부하 분산을 위해 최대 1시간 지연을 설정한다. 활성화: sudo systemctl enable certbot.timer && sudo systemctl start certbot.timer.</p>

<h3>와일드카드 인증서 — DNS 챌린지</h3>
<p>와일드카드(*.example.com)는 HTTP 검증으로 불가능하다. DNS 챌린지를 사용해야 한다. 명령: sudo certbot certonly --manual --preferred-challenges dns -d example.com -d *.example.com. DNS 레코드를 수동으로 추가해야 하는데, Route53 같은 서비스를 사용하면 자동화할 수 있다: sudo apt-get install python3-certbot-dns-route53 후 sudo certbot certonly --dns-route53 -d example.com -d *.example.com.</p>

<h3>모니터링 — 실패를 알아야 한다</h3>
<p>갱신이 실패해도 모르면 안 된다. Bash 스크립트로 인증서 만료 날짜를 확인하고, 7일 이내면 Slack으로 경고를 보낸다. 명령: openssl x509 -enddate -noout -in /etc/letsencrypt/live/example.com/fullchain.pem으로 만료일을 확인할 수 있다. 이 스크립트를 cron에 등록해서 매일 아침 9시에 실행하면, 문제가 생기면 즉시 알 수 있다.</p>

<h3>트러블슈팅</h3>
<p>"Too many requests" 에러가 나면 --staging 플래그로 테스트한다. DNS 챌린지가 작동 안 하면 dig _acme-challenge.example.com TXT로 DNS 레코드가 정말 추가되었는지 확인한다. Nginx 재로드 실패는 renewer_post_hooks에 systemctl reload nginx를 설정해서 해결한다.</p>

<h3>결론</h3>
<p>이제는 인증서 갱신을 자동으로 체크하고, 실패하면 Slack으로 알리며, 갱신 성공하면 Nginx가 자동으로 재로드된다. 인증서가 만료될 수 없다. Let's Encrypt는 무료고 자동화도 어렵지 않다. 2024년에 인증서 만료로 다운되는 건 순전히 게으름이다.</p>


      <div class="author-box">
        <div class="author-avatar">iL</div>
        <div class="author-info">
          <strong>ian.lab</strong>
          <p>실무 개발자입니다. 현장에서 겪은 문제와 해결 과정을 기록합니다. 오류 제보는 <a href="/contact.html">연락처</a>로 보내주세요.</p>
        </div>
      </div>

      <div class="related-posts">
        <h3>관련 글 더 보기</h3>
        <div class="related-list">
        <a class="related-item" href="/posts/post-06.html">
          <span class="ri-cat">DevOps &amp; Infra</span>
          <span class="ri-title">WSL2 개발 환경 실전 세팅 — 네이티브 Linux 성능 비교까지</span>
        </a>
        <a class="related-item" href="/posts/post-29.html">
          <span class="ri-cat">DevOps &amp; Infra</span>
          <span class="ri-title">SSH 터널링 완전 정복 — 원격 서버 개발 환경 구축</span>
        </a>
        <a class="related-item" href="/posts/post-44.html">
          <span class="ri-cat">DevOps &amp; Infra</span>
          <span class="ri-title">남는 기기로 홈서버 만들기 — 안드로이드 폰부터 구형 노트북까지</span>
        </a>
        </div>
      </div>
    </article>
</main>

  <footer class="site-footer">
    <div class="footer-inner">
      <div class="footer-links">
        <a href="/">홈</a>
        <a href="/archive.html">전체 글</a>
        <a href="/about.html">소개</a>
        <a href="/contact.html">연락처</a>
        <a href="/editorial-policy.html">운영 원칙</a>
        <a href="/privacy.html">개인정보처리방침</a>
        <a href="/terms.html">이용약관</a>
      </div>
      <div class="footer-copy">
        &copy; 2026 Goldtag. All rights reserved.<br>
        기술 정보는 실제 사용 환경에 맞게 검토 후 적용하세요.
      </div>
    </div>
  </footer>
</body>
</html>